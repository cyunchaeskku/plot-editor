# 2026-02-26

## 작업 내용

### UI 개선 및 버그 수정 (prompts/8.md)

- **좌측 사이드바 접기/펼치기**: `App.tsx`에 `sidebarOpen` 상태 추가, `◀`/`▶` 토글 버튼으로 `w-56`↔`w-8` 전환. 접힌 상태에서 내용 `hidden` 처리
- **플롯 패널 너비 증가**: `w-64` → `w-72` (256px → 288px)
- **플롯 패널 헤더 작품명 표시**: "작품명 / 플롯 카드" 형태로 현재 편집 중인 작품명 표시
- **플롯 카드 삭제 버튼**: 카드 우측 상단에 `✕` 버튼 추가 (hover 시 표시, confirm 후 삭제)
- **플롯 중복 생성 버그 수정**: `handleCreate`에서 `await` 전에 상태 초기화 (`setNewPlotTitle('')`, `setShowNewPlot(false)`)
- **씬 헤딩 입력창 동적 크기**: `size` 속성 제거, `width`를 `Math.max(60, (length + 2) * 7)px`로 동적 계산
- **대사 툴바 버튼 → 인물 드롭다운**: 등장인물이 있을 때 버튼 클릭 시 인물 목록 드롭다운 표시. `onMouseDown + e.preventDefault()`로 에디터 selection 유지
- **슬래시 메뉴 2단계 구조**: 1단계(씬/나레이션/지문/단락/대사) → 대사 선택 시 2단계 인물 선택. 인물 없으면 빈 대사 즉시 삽입. `◀` 뒤로가기 지원
- **docx 내보내기 콜론 정렬**: 대사 단락에 `TabStopType.LEFT, position: 1440` 적용, `characterName\t: dialogue` 형태로 콜론 위치 고정
- **docx 내보내기 범위 선택**: 내보내기 버튼 클릭 시 "현재 에피소드만" / "전체 작품" 모달 표시
- **docx 씬 헤딩 장소·시간 우측 정렬**: `TabStopType.RIGHT, position: 8640` 탭 스톱으로 씬 제목 좌측, 장소·시간 우측 정렬
- **텍스트 서식 버튼 추가**: 툴바 우측에 Bold(`B`), Italic(`I`), Underline(`U`), 취소선(`S`) 버튼 추가. `@tiptap/extension-underline` 설치

## 결정 사항

- 드롭다운 외부 클릭 감지는 `onMouseLeave` 대신 `document.addEventListener('mousedown', ...)` 방식 채택 → 버튼과 드롭다운 사이 갭에서 닫히는 문제 방지
- 툴바 버튼은 모두 `onClick` → `onMouseDown + e.preventDefault()`로 변경하여 에디터 커서 selection 보존
- 슬래시 메뉴 기존 flat 구조(`대사: 인물명`) → 2단계 구조로 전환. 인물 없을 때도 "대사" 항목 항상 노출
- docx `TabStopLeader` → 실제 export 명칭 `LeaderType` 으로 수정 (버전 차이)

## 이슈/메모

- `@tiptap/extension-underline`은 StarterKit에 미포함, 별도 설치 필요
- docx 라이브러리의 `TabStopLeader`가 export되지 않음 → `LeaderType.NONE` 사용
- 슬래시 메뉴 항목 클릭을 `onClick` → `onMouseDown + e.preventDefault()`로 변경해야 editor selection이 유지됨 (클릭 시 editor blur 방지)
