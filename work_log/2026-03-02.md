# 2026-03-02

## ì‘ì—… ë‚´ìš©

### 1. ê²Œì‹œíŒ (Community Thread) í˜ì´ì§€ ì¶”ê°€

ë”ë¯¸ ë°ì´í„° ê¸°ë°˜ UIë¥¼ êµ¬ì„±í–ˆë‹¤. AWS ì—°ê²° ì—†ì´ ì»¤ë®¤ë‹ˆí‹° í”¼ë“œ/ìƒì„¸ í™”ë©´ì„ ì™„ì„±í–ˆë‹¤.

#### êµ¬ì¡° ë³€ê²½: React Router ë„ì…

`react-router-dom v6`ì„ ì¶”ê°€í•˜ê³ , ê¸°ì¡´ ë‹¨ì¼ App.tsxë¥¼ ë¼ìš°íŒ… êµ¬ì¡°ë¡œ ë¶„ë¦¬í–ˆë‹¤.

**ë¼ìš°íŠ¸ ì„¤ê³„:**
- `/` â†’ `EditorPage` (ê¸°ì¡´ ì—ë””í„°)
- `/thread` â†’ `ThreadBoard` (ì»¤ë®¤ë‹ˆí‹° ê²Œì‹œíŒ)
- ë‘ ë¼ìš°íŠ¸ ëª¨ë‘ `RootLayout` ì•„ë˜ì—ì„œ Sidebar ê³µìœ 

#### íŒŒì¼ êµ¬ì¡°

```
src/
â”œâ”€â”€ main.tsx              â† RouterProviderë¡œ êµì²´
â”œâ”€â”€ router.tsx            â† createBrowserRouter ì •ì˜ (ì‹ ê·œ)
â”œâ”€â”€ layouts/
â”‚   â””â”€â”€ RootLayout.tsx    â† Sidebar + Outlet + JWT ì´ˆê¸°í™” (ì‹ ê·œ)
â””â”€â”€ pages/
    â”œâ”€â”€ EditorPage.tsx    â† App.tsx ì—ë””í„° ë‚´ìš© ì¶”ì¶œ (ì‹ ê·œ)
    â””â”€â”€ ThreadBoard/
        â”œâ”€â”€ index.tsx     â† ì¤‘ê°„+ìš°ì¸¡ íŒ¨ë„ ë ˆì´ì•„ì›ƒ (ì‹ ê·œ)
        â”œâ”€â”€ ThreadFeed.tsx   â† ê²Œì‹œê¸€ í”¼ë“œ + íƒ­ + ê²€ìƒ‰ (ì‹ ê·œ)
        â”œâ”€â”€ PostCard.tsx  â† ê²Œì‹œê¸€ ì¹´ë“œ ì»´í¬ë„ŒíŠ¸ (ì‹ ê·œ)
        â”œâ”€â”€ ThreadDetail.tsx â† ìƒì„¸ + ëŒ“ê¸€ (ì‹ ê·œ)
        â””â”€â”€ dummyData.ts  â† ë”ë¯¸ ë°ì´í„° (ì‹ ê·œ)
```

#### ì±…ì„ ì¬ë°°ë¶„

| ì´ì „ (App.tsx) | ì´í›„ |
|---|---|
| Sidebar ë Œë”ë§ | RootLayout.tsx |
| JWT ì¶”ì¶œ + loadUserInfo + loadWorks | RootLayout.tsx |
| ì—ë””í„° ìƒíƒœ (viewMode, plotMode ë“±) | EditorPage.tsx |
| beforeunload + Cmd+S í•¸ë“¤ëŸ¬ | EditorPage.tsx |

ê¸°ì¡´ `App.tsx`ëŠ” ì‚­ì œí•˜ì§€ ì•Šê³  ê·¸ëŒ€ë¡œ ë‘  (ë” ì´ìƒ importë˜ì§€ ì•ŠëŠ” dead code).

#### ThreadBoard UI

**ì¤‘ê°„ íŒ¨ë„ (ThreadFeed):**
- íƒ­: ê´‘ì¥ | ë‚´ ê¸€ | ì•Œë¦¼
- ê²€ìƒ‰ì°½ + "ìƒˆë¡œìš´ ê¸€ ì“°ê¸°" ë²„íŠ¼
- PostCard ëª©ë¡

**PostCard:**
- ì‘ê°€ ì•„ë°”íƒ€ (ì´ë‹ˆì…œ ì›í˜•, ê³ ìœ  ìƒ‰ìƒ)
- ì œëª© + ì„¤ëª…
- ì”¬ ë¯¸ë¦¬ë³´ê¸° (ì”¬ í—¤ë”© + ì¥ì†Œ/ì‹œê°„ + ëŒ€ì‚¬ 2ê°œ) â€” plot íƒ€ì…
- ì±•í„° ì œëª© + ë°œì·Œ â€” novel íƒ€ì…
- íƒœê·¸ ë°°ì§€
- ì¡°íšŒ/ì¢‹ì•„ìš”/ëŒ“ê¸€ ìˆ˜ + "ìì„¸íˆ ë³´ê¸°" ë²„íŠ¼

**ìš°ì¸¡ íŒ¨ë„ (ThreadDetail):**
- ê²Œì‹œê¸€ ì „ì²´ ë¯¸ë¦¬ë³´ê¸°
- ìµœì‹ ìˆœ/ì¸ê¸°ìˆœ ì •ë ¬
- ëŒ“ê¸€ ëª©ë¡ (ëŒ“ê¸€ ìˆ˜ì— ë”°ë¼ ë™ì  ë Œë”ë§)
- ëŒ“ê¸€ ì…ë ¥ + ë“±ë¡ (ë¡œì»¬ ìƒíƒœë¡œ ë”ë¯¸ ì¶”ê°€)
- í•˜ë‹¨: ì „ì²´ ê²Œì‹œê¸€ ìˆ˜ + ì˜¨ë¼ì¸ ì‘ê°€ ìˆ˜

#### ë”ë¯¸ ë°ì´í„°

`dummyData.ts`ì— 6ê°œ ê²Œì‹œê¸€, 14ê°œ ëŒ“ê¸€. í•œêµ­ ë¬¸í•™/í¬ê³¡ ì†Œì¬.
ê° ì‘ê°€ë§ˆë‹¤ ê³ ìœ  avatar ìƒ‰ìƒ ì§€ì •.

#### Community ë²„íŠ¼

EditorPageì˜ ìš°ì¸¡ íŒ¨ë„ íƒ­ ë°” ìš°ì¸¡ì— `<Link to="/thread">ğŸŒ ì»¤ë®¤ë‹ˆí‹°</Link>` ì¶”ê°€.
ì»¤ë®¤ë‹ˆí‹° â†’ ì—ë””í„° ë³µê·€ëŠ” ë¸Œë¼ìš°ì € ë’¤ë¡œê°€ê¸° ë˜ëŠ” `/` URLë¡œ ì´ë™.

#### CSS ì¶”ê°€ (App.css)

- `.post-card`, `.post-card--selected` â€” ì¹´ë“œ í…Œë‘ë¦¬, hover/selected ìƒíƒœ
- `.post-avatar`, `.post-avatar--sm` â€” ì›í˜• ì•„ë°”íƒ€
- `.post-tag` â€” íƒœê·¸ ë°°ì§€ (ì—°í•œ íšŒìƒ‰ ë°°ê²½ + ì§„í•œ í…ìŠ¤íŠ¸)
- `.scene-preview`, `.scene-preview__heading`, `.scene-preview__meta`, `.scene-preview__dialogues` â€” ì”¬ ë¯¸ë¦¬ë³´ê¸° ë¸”ë¡
- `.dialogue-preview`, `.dialogue-preview__name`, `.dialogue-preview__text` â€” ëŒ€ì‚¬ ë¼ì¸
- `.thread-tab`, `.thread-tab--active` â€” ê²Œì‹œíŒ íƒ­

#### íŒ¨í‚¤ì§€ ì¶”ê°€

- `react-router-dom` â€” `npm install react-router-dom`

---

### 2. ë„“ê²Œ ë³´ê¸° (Expand Mode) ì¶”ê°€

ê²Œì‹œê¸€ ìƒì„¸ ìš°ì¸¡ íŒ¨ë„ì—ì„œ í”¼ë“œ íŒ¨ë„ì„ ìˆ¨ê¸°ê³  ìƒì„¸ ë·°ë¥¼ ì „ì²´ ë„ˆë¹„ë¡œ í™•ì¥í•˜ëŠ” ëª¨ë“œë¥¼ êµ¬í˜„í–ˆë‹¤.

- `ThreadBoard/index.tsx`: `isExpanded` ìƒíƒœ ì¶”ê°€. `!isExpanded`ì¼ ë•Œë§Œ í”¼ë“œ íŒ¨ë„ ë Œë”ë§.
- `PostCard.tsx`: `onClick`(ì„ íƒ)ê³¼ `onExpand`(ë„“ê²Œ ë³´ê¸°) ì´ë²¤íŠ¸ ë¶„ë¦¬.
- `ThreadFeed.tsx`: `â† ì—ë””í„°ë¡œ` Link ì¶”ê°€ (ìƒë‹¨). `onExpandPost` prop ì „ë‹¬.
- `ThreadDetail.tsx`: `expanded` propì— ë”°ë¼ ë ˆì´ì•„ì›ƒ ë¶„ê¸°, `â† ëª©ë¡ìœ¼ë¡œ` ë²„íŠ¼, `â¤¢ ë„“ê²Œ` ë²„íŠ¼.

---

### 3. ê²Œì‹œíŒ plot/novel íƒ€ì… ë¶„ë¦¬ + ë¦¬ë” ëª¨ë“œ êµ¬í˜„

#### dummyData.ts ì¬êµ¬ì¡°í™”

**íƒ€ì… ë¶„ë¦¬ (discriminated union):**
- `PlotPost` â€” `work_type: 'plot'`, `content_preview: PlotContentPreview`, `full_content: PlotFullContent`
- `NovelPost` â€” `work_type: 'novel'`, `content_preview: NovelContentPreview`, `full_content: NovelFullContent`
- `type Post = PlotPost | NovelPost`

**PlotFullContent**: scenes ë°°ì—´, ê° sceneì€ `scene_heading/location/time + blocks[]`
- block type: `'dialogue'` | `'narration'` | `'stage_direction'`

**NovelFullContent**: `chapter_title + paragraphs[]`

ê¸°ì¡´ 6ê°œ í¬ìŠ¤íŠ¸ì— `work_type: 'plot'`ê³¼ `full_content` ì¶”ê°€.
ìƒˆ novel í¬ìŠ¤íŠ¸ 2ê°œ ì¶”ê°€ (id 7, 8).

#### PostCard.tsx: work_type ë¶„ê¸°

- `post.work_type === 'plot'` â†’ ì”¬ ë¯¸ë¦¬ë³´ê¸° ë¸”ë¡ (ê¸°ì¡´)
- `post.work_type === 'novel'` â†’ ì±•í„° ì œëª© + ë°œì·Œ ë¸”ë¡ (`.novel-preview`)

#### ThreadDetail.tsx: ë¦¬ë” ëª¨ë“œ

- `isReaderMode: boolean` ìƒíƒœ ì¶”ê°€
- ì”¬ ë¯¸ë¦¬ë³´ê¸° / ì†Œì„¤ ë¯¸ë¦¬ë³´ê¸° ë¸”ë¡ í•˜ë‹¨ì— "ìì„¸íˆ ë³´ê¸° â†—" ë²„íŠ¼ ì¶”ê°€
- í´ë¦­ ì‹œ `isReaderMode = true` â†’ ìš°ì¸¡ íŒ¨ë„ì´ ì—ë””í„° ìŠ¤íƒ€ì¼ ë¦¬ë” ëª¨ë“œë¡œ ì „í™˜
- **Plot ë¦¬ë”**: ì”¬ë³„ë¡œ ì”¬ í—¤ë”© + meta + blocks ë Œë”ë§
  - `dialogue`: ì¢Œì¸¡ ì»¬ëŸ¬ ë³´ë” + ìºë¦­í„°ëª… + ëŒ€ì‚¬
  - `narration`: ì¤‘ì•™ ì •ë ¬, ì´íƒ¤ë¦­, íšŒìƒ‰
  - `stage_direction`: ë“¤ì—¬ì“°ê¸°, ì´íƒ¤ë¦­
- **Novel ë¦¬ë”**: ì±•í„° ì œëª© + ë‹¨ë½ ëª©ë¡ (ë“¤ì—¬ì“°ê¸°, ë„‰ë„‰í•œ ì¤„ê°„ê²©)
- ë¦¬ë” ëª¨ë“œ í—¤ë”: "â† ë‹«ê¸°" ë²„íŠ¼, ì†ŒíŠ¸/ë„“ê²Œ ë²„íŠ¼ ìˆ¨ê¹€
- ë¦¬ë” ëª¨ë“œì—ì„œ ëŒ“ê¸€ ì…ë ¥ì°½, í‘¸í„° ìˆ¨ê¹€

#### App.css ì¶”ê°€

- `.novel-preview`, `.novel-preview__chapter`, `.novel-preview__excerpt`
- `.reader-scene`, `.reader-scene__heading`, `.reader-scene__meta`, `.reader-scene__blocks`
- `.reader-dialogue`, `.reader-dialogue__name`, `.reader-dialogue__text`
- `.reader-narration`, `.reader-stage-direction`
- `.reader-novel__chapter`, `.reader-novel__paragraph`

## ê²€ì¦

- `npm run build` â€” âœ… 0 TypeScript ì˜¤ë¥˜, ë¹Œë“œ ì„±ê³µ

## ë‹¤ìŒ ì‘ì—…

1. ê²Œì‹œê¸€ ê³µìœ  ê¸°ëŠ¥ (ë‚´ ì‘í’ˆ â†’ ê²Œì‹œíŒ ê³µìœ  ëª¨ë‹¬)
2. ëŒ“ê¸€ AWS ë°±ì—”ë“œ ì—°ê²°
3. ë‚´ ê¸€ íƒ­ â€” í˜„ì¬ ë¡œê·¸ì¸ ìœ ì € ê¸°ì¤€ í•„í„° ì—°ê²°
4. ì‹¤ì œ AWSì—ì„œ post ë°ì´í„° ì—°ê²° (plot_id ê¸°ë°˜ìœ¼ë¡œ ê³µìœ ëœ ê²Œì‹œê¸€ fetching)
