# 2026-02-26 (3차)

## 작업 내용

### 1. 다크모드 완전 제거
- `tailwind.config.js`: `darkMode: 'class'` 제거
- `App.tsx`: `darkMode` 상태/useEffect/localStorage/토글 버튼 전부 제거, 모든 `dark:` Tailwind 클래스 제거
- `App.css`: `.dark .planning-editor` 규칙 제거, `.planning-editor` 색상 `#111827`로 명확화
- `PlanningDoc/index.tsx`: 툴바·에디터 wrapper에서 `dark:` 클래스 전부 제거

### 2. 관계도 PNG 내보내기 — Controls/MiniMap/워터마크 제외
- `GraphView/index.tsx` `toPng` 호출에 `filter` 옵션 추가
- `react-flow__panel` (Controls + MiniMap 컨테이너), `react-flow__attribution` (워터마크) 클래스 노드를 필터링

### 3. 기획서 에디터 폰트 색상 수정
- `.planning-editor` color를 `#111827`로 명시 → 다크모드 제거와 함께 배경/텍스트 충돌 근본 해결

### 4. 기획서 에디터 — 정렬 / 텍스트 색 / 텍스트 크기 추가
- 패키지 설치: `@tiptap/extension-text-align`, `@tiptap/extension-color`, `@tiptap/extension-text-style`
- `FontSize` 커스텀 Extension 인라인 정의 (TextStyle 기반 `fontSize` attribute)
- 툴바에 추가:
  - 정렬 버튼 3개 (⬅ 좌측 / ↔ 가운데 / ➡ 우측)
  - 텍스트 색상 `<input type="color">`
  - 텍스트 크기 `<select>` (12px~32px)
- docx 내보내기에 color, fontSize, textAlign 반영

### 5. 관계도 노드 클릭 컨텍스트 메뉴 + 관계 추가 플로우
- 노드 단일 클릭 → 컨텍스트 메뉴 표시 (두 항목):
  - 🔗 **관계 추가**: 연결 모드 진입
  - 👤 **인물 상세 정보**: 우측 패널을 인물 상세 탭으로 전환
- 연결 모드 시 소스 노드에 보라색 링, 대상 후보 노드에 초록색 링 하이라이트
- 상단 배너로 "○○에서 → 관계를 연결할 인물을 클릭하세요" 안내
- 대상 노드 클릭 → 관계 이름 입력 모달 (소스→타겟 인물명 표시, Enter로 확인)
- ESC 또는 캔버스 빈 곳 클릭 → 연결 모드 취소
- 더블클릭은 기존 동작(인물 상세 이동) 유지
- `TextStyle` import를 named export로 수정 (`{ TextStyle }`)

## 결정 사항
- 다크모드는 체감 변화가 없어 완전 제거; 라이트 grey 테마(`#f4f5f7`) 단일 유지
- 관계 추가는 별도 사이드바 UI 대신 그래프 위 인터랙션으로 처리 (노드 클릭 체이닝)
- 관계 이름 미입력 시 기본값 `'관계'`로 저장

## 이슈/메모
- `@tiptap/extension-text-style`은 default export가 없으므로 named import `{ TextStyle }` 사용
- ReactFlow `onNodeClick` 이벤트의 `event.clientX/Y`에서 컨테이너 `getBoundingClientRect()` 빼면 컨텍스트 메뉴 위치를 정확히 계산 가능
- 연결 모드 하이라이트는 `setNodes` data 필드 업데이트로 CharacterNode에 props 전달
